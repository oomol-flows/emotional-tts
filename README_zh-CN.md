# IndexTTS2 文字转语音 OOMOL 插件

将任何文本转换为自然、富有情感表现力的语音，支持 AI 语音克隆。

## 这是什么？

此 OOMOL 插件包提供强大的文字转语音系统，可以：

- **克隆任何声音** 只需 3-15 秒的音频样本！
- **控制情感** 生成的语音可以是快乐、悲伤、愤怒、平静等
- **支持多语言** 包括中文和英文
- **生成高质量音频** 听起来自然且富有表现力

非常适合内容创作者、有声书制作者、无障碍应用，或任何需要真实 AI 语音的场景。

## 可用区块

### IndexTTS2 语音合成

**功能说明：** 使用您提供的 AI 声音将文本转换为语音音频。

**核心特性：**

- **声音克隆：** 上传任何声音的短录音，AI 将模仿该声音
- **情感控制：** 选择声音应该如何表达（兴奋、平静、担忧等）
- **多语言：** 支持中文和英文文本
- **专业品质：** 生成适合制作使用的录音室级音频

### SRT 字幕语音合成

**功能说明：** 将 SRT 字幕文件转换为同步语音音频，自动将生成的语音与字幕时间戳对齐。

**核心特性：**

- **自动同步：** 生成与字幕时间戳同步的音频
- **批量处理：** 一次性处理所有字幕条目
- **完整情感控制：** 使用与基本合成区块相同的情感控制功能
- **速度调整：** 可选调整语音速度以更好地适应字幕时间
- **元数据输出：** 生成带有音频时长信息的注释 SRT 文件

### 视频语音翻译（子流程）

**功能说明：** 将视频语音从一种语言翻译成另一种语言，同时保留原始说话人的声音特征。这是一个完整的端到端流程，可以自动处理您的视频。

**核心特性：**

- **完整流程：** 提取音频 → 转录 → 翻译 → 合成 → 替换音频
- **声音保留：** 在目标语言中保持原始说话人的声音音色
- **多语言支持：** 支持所有主要语言（英语、中文、西班牙语、法语、德语、日语、韩语、俄语、阿拉伯语、葡萄牙语、意大利语、荷兰语、波兰语、土耳其语、越南语、泰语、印尼语、印地语）
- **自动同步：** 自动将翻译的语音与原始视频时间同步
- **一键操作：** 上传视频，选择语言，即可获得翻译版本

## 使用场景

### 1. 内容创作
- 为视频生成配音，无需录音
- 用不同声音创建播客节目
- 制作具有一致叙述风格的有声书
- **新增：** 将视频字幕转换为同步叙述音轨

### 2. 无障碍
- 为视障用户将书面内容转换为音频
- 创建文档和文章的音频版本
- 生成多语言音频内容
- **新增：** 从字幕文件生成音频描述

### 3. 原型设计
- 为项目测试不同的声音风格
- 创建音频原型，无需聘请配音演员
- 为故事讲述实验不同的情感基调

### 4. 教育培训
- 制作教育音频材料
- 创建语言学习内容
- 生成一致的教学旁白
- **新增：** 从字幕文本创建同步音频课程

### 5. 视频制作
- **新增：** 使用字幕文件为无声视频添加旁白
- **新增：** 创建自定义声音的配音版本
- **新增：** 生成与现有字幕同步的音轨

### 6. 视频本地化与翻译
- **新增：** 将视频内容翻译成不同语言，同时保留原始声音
- **新增：** 创建教育视频或教程的多语言版本
- **新增：** 为国际观众本地化营销视频
- **新增：** 生成访谈或纪录片的配音版本

## 如何使用

### 基础用法

1. **准备输入内容：**
   - **文本：** 您想转换为语音的内容
   - **声音样本：** 您想克隆的声音的 3-15 秒音频文件（WAV、MP3 或 FLAC）

2. **将区块添加到流程：**
   - 将"IndexTTS2 语音合成"区块拖入您的 OOMOL 工作流
   - 连接文本输入
   - 上传声音参考音频

3. **选择情感控制模式：**
   - **说话人模式**（默认）：使用声音样本中的情感
   - **参考模式**：使用不同的音频文件控制情感
   - **向量模式**：使用滑块混合不同情感
   - **文本模式**：用文字描述您想要的情感

4. **运行流程：**
   - 区块将生成包含合成语音的 WAV 音频文件

### SRT 字幕转语音用法

1. **准备输入内容：**
   - **SRT 文件：** 您的字幕文件（必须是有效的 SRT 格式，带时间戳）
   - **声音样本：** 您想克隆的声音的 3-15 秒音频文件

2. **将区块添加到流程：**
   - 将"SRT 字幕语音合成"区块拖入您的 OOMOL 工作流
   - 上传您的 SRT 字幕文件
   - 上传您的声音参考音频
   - （可选）选择情感控制模式并调整设置

3. **配置可选设置：**
   - **速度因子：** 调整语音速度（0.5-2.0倍，默认：1.0）
   - **情感控制：** 与基本合成相同的选项
   - **质量参数：** 温度、top-p、top-k 设置

4. **运行流程：**
   - 区块将处理所有字幕并生成：
     - 与字幕时间戳对齐的同步音频文件（WAV）
     - 显示音频时长与目标时长的元数据 SRT 文件

**工作原理：**
- 每个字幕条目单独合成
- 生成的音频片段放置在正确的时间戳
- 自动在片段之间添加静音
- 最终音频时长与最后一个字幕的结束时间匹配

### 视频语音翻译用法

1. **准备输入内容：**
   - **视频文件：** 任何视频文件（MP4、AVI、MOV、MKV、WebM、FLV）
   - **语言设置：**
     - 源语言（或选择"自动检测"）
     - 目标翻译语言

2. **将子流程添加到工作流：**
   - 将"视频语音翻译"子流程拖入您的 OOMOL 工作流
   - 上传您的视频文件
   - 选择源语言和目标语言

3. **幕后工作流程：**
   - **步骤 1：** 从视频中提取音频
   - **步骤 2：** 将音频转录为 SRT 字幕
   - **步骤 3：** 将字幕翻译成目标语言
   - **步骤 4：** 从原始音频生成声音样本（前 25 秒）
   - **步骤 5：** 使用克隆的声音合成翻译后的语音
   - **步骤 6：** 用翻译后的语音替换原始音轨

4. **运行流程：**
   - 子流程将自动执行所有步骤
   - 输出：带有目标语言翻译语音的视频文件
   - 保留原始说话人的声音特征

**使用案例示例：** 您有一个英语教程视频，想要创建中文版本。子流程将自动提取音频、转录、翻译成中文、克隆说话人的声音、生成听起来像原始说话人的中文语音，并替换音轨 - 所有这些都在一个自动化流程中完成！

### 情感控制选项

#### 简单：说话人模式
生成的语音与您的声音样本中的情感相匹配。如果您的样本听起来很快乐，输出也会听起来很快乐。

#### 高级：参考模式
使用两个音频文件：
- **声音样本：** 提供声音音色（听起来像谁）
- **情感样本：** 提供情感风格（听起来怎么样）

示例：克隆 A 的声音，但使用 B 的充满活力的说话风格。

#### 精确：向量模式
使用 8 个滑块微调情感：
- 快乐
- 愤怒
- 悲伤
- 恐惧
- 厌恶
- 忧郁
- 惊讶
- 平静

混合搭配强度（0.0 到 1.0）以创建完美的情感基调。

#### 创意：文本模式
用自然语言描述您想要的情感：
- "危险在悄悄逼近"
- "你吓死我了！你是鬼吗？"
- "这是我今天听到的最好消息"

AI 将解释您的描述并应用该情感风格。

## 要求

### 系统要求
- **GPU：** 推荐使用支持 CUDA 的 GPU（NVIDIA）
- **内存：** 12GB 显存（GPU）或 16GB 内存（CPU）
- **存储：** 约 20GB 可用空间用于模型和依赖项

### 音频要求
- **声音样本质量：** 清晰、无噪音的录音
- **时长：** 3-15 秒（更长不一定更好）
- **单一说话人：** 只有一个人在说话
- **格式：** WAV、MP3、FLAC 或 M4A

## 安装

### 自动设置
此插件包是完全独立的。首次使用时，OOMOL 将自动：

1. 安装所有必需的 Python 包
2. 下载 IndexTTS2 AI 模型（约 10GB）
3. 设置处理环境

**首次设置需要 10-20 分钟**，具体取决于您的网速。之后，区块即可立即使用。

### 手动设置（可选）
如果自动设置失败，模型存储在：
```
/oomol-driver/oomol-storage/indextts-checkpoints/
```

## 获得最佳效果的技巧

### 声音质量
✅ **建议：**
- 使用清晰、专业质量的音频
- 在安静的环境中录制
- 仅使用单一说话人
- 提供 5-10 秒的清晰语音

❌ **避免：**
- 嘈杂或有回音的录音
- 多人同时说话
- 音乐或背景声音
- 非常短的样本（<3 秒）

### SRT 字幕文件
✅ **最佳实践：**
- 使用格式正确的 SRT 文件，带有效的时间戳
- 保持字幕文本简洁（较短的片段效果更好）
- 确保字幕时长合理（每个条目至少 2-3 秒）
- 对国际字符使用 UTF-8 编码
- 如果音频对于时间来说太快/太慢，请使用 speed_factor 调整进行测试

⚠️ **已知限制：**
- 非常短的字幕时长（<1 秒）可能无法容纳生成的音频
- 非常长的字幕文本可能被截断（使用 max_mel_tokens 参数）
- 生成的音频放置在精确的时间戳（如果字幕太接近可能重叠）

### 情感控制
- **获得自然效果：** 使用说话人模式和录制良好的样本
- **获得创意控制：** 尝试文本模式，情感权重 0.6-0.7
- **精确调整：** 使用向量模式，保持总情感和 ≤ 0.8
- **戏剧效果：** 将参考模式与富有表现力的情感样本结合使用

### 文本输入
- 较长的文本会自动分割成句子
- 支持标点符号以实现自然停顿
- 使用格式正确的文本效果最佳
- 支持中文和英文

## 高级参数

针对想要更多控制的用户：

| 参数 | 范围 | 描述 |
|-----------|-------|-------------|
| **温度** | 0.1 - 2.0 | 更高 = 更多样化，更低 = 更稳定（默认：0.8） |
| **情感权重** | 0.0 - 1.0 | 情感应该有多强（默认：0.65） |
| **最大音频长度** | 50 - 1500 tokens | 生成音频的最大长度 |
| **句子分割** | 20 - 200 tokens | 如何将长文本分割成片段 |

## 故障排除

### 音频质量问题
- **问题：** 声音听起来不像参考音频
  - **解决方案：** 使用更高质量的参考音频（清晰、无噪音）

- **问题：** 情感太强或太弱
  - **解决方案：** 调整情感权重（尝试 0.5-0.8 范围）

- **问题：** 声音听起来机械化
  - **解决方案：** 将温度降低到 0.6-0.7 以获得更稳定的效果

### 技术问题
- **问题：** 内存不足错误
  - **解决方案：** 减少最大音频长度或使用较短的文本输入

- **问题：** 未找到模型
  - **解决方案：** 等待自动下载，或重启 OOMOL 重试

- **问题：** 处理速度慢
  - **解决方案：** GPU 处理速度比 CPU 快 10-20 倍

## 模型信息

- **模型：** IndexTTS2 by Bilibili AI
- **技术：** 零样本文字转语音，具有情感控制
- **语言：** 中文、英文
- **许可证：** Bilibili IndexTTS License
- **来源：** [github.com/index-tts/index-tts](https://github.com/index-tts/index-tts)
- **研究论文：** [arXiv:2506.21619](https://arxiv.org/abs/2506.21619)

### 商业使用
商业授权咨询，请联系：indexspeech@bilibili.com

## 支持与社区

- **演示：** 在 [HuggingFace Space](https://huggingface.co/spaces/IndexTeam/IndexTTS-2-Demo) 试用在线演示
- **问题：** 在 [GitHub](https://github.com/index-tts/index-tts/issues) 上报告错误
- **Discord：** 加入社区 https://discord.gg/uT32E7KDmy
- **QQ 群：** 553460296, 663272642（中文社区）

## 示例工作流

### 基础文字转语音工作流

1. **文本输入区块** → 输入您的脚本
2. **文件输入区块** → 上传您的声音样本（5-10 秒）
3. **IndexTTS2 区块** → 连接文本和音频输入
4. **音频输出区块** → 保存或播放生成的语音

### SRT 字幕语音合成工作流

1. **文件输入区块** → 上传您的 SRT 字幕文件
2. **文件输入区块** → 上传您的声音样本（5-10 秒）
3. **SRT 字幕语音合成区块** → 连接两个文件输入
4. **音频输出区块** → 保存同步音轨
5. **文件输出区块** → 保存元数据 SRT 文件（可选）

**使用案例示例：** 您有一个带字幕但没有音频的视频。上传 SRT 文件，提供声音样本，生成与字幕时间完美匹配的同步叙述音轨！

### 视频语音翻译工作流

1. **文件输入区块** → 上传您的源视频文件（例如 English.mp4）
2. **视频语音翻译子流程** → 连接视频输入
   - 将源语言设置为"自动检测"或特定语言
   - 设置目标语言（例如中文、西班牙语等）
3. **文件输出区块** → 保存翻译后的视频

**使用案例示例：** 您有一个 10 分钟的英语教程视频，想要创建中文、西班牙语和法语版本。使用不同的目标语言使用此子流程三次，您将获得三个本地化版本，同一个说话人的声音自然地讲每种语言！

## 许可证

此插件包使用 IndexTTS2，该模型根据 Bilibili IndexTTS License 授权。商业使用前请查看许可条款。

## 致谢

- **IndexTTS2 模型：** Bilibili AI 团队
- **研究：** Zhou et al. (2025)
- **OOMOL 插件包：** alwaysmavs

---

**准备好开始了吗？** 将 IndexTTS2 区块添加到您的 OOMOL 工作流，用 AI 语音让您的文本栩栩如生！
